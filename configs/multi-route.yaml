# Multi-Route SignalFence Configuration
# Different rate limits for different API endpoints

defaults:
  capacity: 20           # Default: moderate limits
  refill_rate: 1.0       # 60 req/min sustained
  enabled: true

policies:
  # Strict limits for authentication (prevent brute force)
  "/api/login":
    capacity: 5
    refill_rate: 0.083   # ~5 req/min (1 every 12 seconds)
    enabled: true

  "/api/register":
    capacity: 3
    refill_rate: 0.05    # ~3 req/min (1 every 20 seconds)
    enabled: true

  # Lenient limits for read operations
  "/api/search":
    capacity: 100
    refill_rate: 10.0    # 600 req/min
    enabled: true

  "/api/list":
    capacity: 50
    refill_rate: 5.0     # 300 req/min
    enabled: true

  # Moderate limits for write operations
  "/api/create":
    capacity: 20
    refill_rate: 0.33    # ~20 req/min (1 every 3 seconds)
    enabled: true

  "/api/update":
    capacity: 30
    refill_rate: 0.5     # ~30 req/min (1 every 2 seconds)
    enabled: true

  "/api/delete":
    capacity: 10
    refill_rate: 0.166   # ~10 req/min (1 every 6 seconds)
    enabled: true

key_extractor: "header:X-API-Key"  # Identify by API key
cleanup_age: "30m"                  # Clean up after 30 minutes of inactivity
